openapi: 3.0.0
info:
  title: ITDA
  description: ITDA API docs
  version: 0.0.0
servers:
  - url: https://0.0.0.0/api/v1
tags:
  - name: Auth
    description: Authentication Operations
  - name: My Profile
    description: User Profile related Operations
  - name: Programs
    description: Government Program related Operations
paths:
  /auth/signup:
    post:
      tags:
        - Auth
      summary: Sign up for the service
      description: Sign up for the service
      requestBody:
        required: true
        description: Signup credentials
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AuthRequest"
      responses:
        '200':
          description: Sign up successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        default:
          description: Unexpected server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /auth/login:
    post:
      tags:
        - Auth
      summary: Authenticate user
      description: Log in with email and password to receive JWT tokens.
      requestBody:
        required: true
        description: Login credentials
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AuthRequest"
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        default:
          description: Unexpected server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /my-profile:
    get:
      tags:
        - My Profile
      summary: Get user profile
      description: Get user profile
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    put:
      tags:
        - My Profile
      summary: Update user profile
      description: Update user profile
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: Updated user profile
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProfileRequest'
      responses:
        '200':
          description: Success
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /my-profile/preferences:
    put:
      tags:
        - My Profile
      summary: Update user preferences
      description: Update user preferences
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: Updated user preferences
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/PreferenceUpdateRequest'
      responses:
        '200':
          description: Success
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  
  /users/me/bookmarks:
    get:
      tags:
        - My Profile
      summary: 북마크된 프로그램 목록 조회
      description: 현재 사용자가 북마크한 프로그램 목록을 지정된 정렬 기준으로 페이지네이션하여 조회합니다.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: sort
          schema:
            $ref: '#/components/schemas/BookmarkSortType'
          required: false
          description: 정렬 기준 (LATEST:-> 북마크 최신순(default), DEADLINE -> 마감 임박순)
        - in: query
          name: page
          schema:
            type: integer
          required: false
          description: 요청할 페이지 번호 (0부터 시작).
        - in: query
          name: size
          schema:
            type: integer
          required: false
          description: 한 페이지에 포함될 항목 수.
      responses:
        '200':
          description: 북마크된 프로그램 목록 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProgramSummaryResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /programs:
    get:
      tags:
        - Programs
      summary: Get programs
      description: Get programs specific for the user
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProgramSummaryResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /programs/{id}:
    get:
      tags:
        - Programs
      summary: Get program details
      description: Retrieve detailed information about a program by its ID
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the program to retrieve
          schema:
            type: integer
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProgramResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /programs/examples:
    get:
      tags:
        - Programs
      summary: Get example programs
      description: Get example programs for preference update
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProgramSummaryResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /programs/examples/{id}:
    get:
      tags:
        - Programs
      summary: Get example program details
      description: Retrieve detailed information about an example program by its ID
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the program to retrieve
          schema:
            type: integer
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProgramResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /programs/categories:
    get:
      tags:
        - Programs
      summary: Get program categories
      description: Get program categories
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProgramCategoryResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /programs/search/latest:
    get:
      tags:
        - Programs
      summary: 최신순으로 프로그램 검색
      description: Get the latest added programs
      parameters:
        - in: query
          name: query
          schema:
            type: string
          required: true
          description: 검색할 프로그램의 검색어입니다.
        - in: query
          name: page
          schema:
            type: integer
            default: 0
          required: false
          description: 요청할 페이지 번호 (0부터 시작). 기본값은 0입니다.
        - in: query
          name: size
          schema:
            type: integer
            default: 10
          required: false
          description: 한 페이지에 포함될 항목 수. 기본값은 10입니다.
      responses:
        '200':
          description: 랭킹 순으로 정렬된 프로그램 목록 (페이지네이션 적용).
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProgramSummaryResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /programs/search/rank:
    get:
      tags:
        - Programs
      summary: 랭킹 순으로 프로그램 검색
      operationId: searchProgramsByRank
      parameters:
        - in: query
          name: query
          schema:
            type: string
          required: true
          description: 검색할 프로그램의 검색어입니다.
        - in: query
          name: page
          schema:
            type: integer
            format: int32
            default: 0
          required: false
          description: 요청할 페이지 번호 (0부터 시작). 기본값은 0입니다.
        - in: query
          name: size
          schema:
            type: integer
            format: int32
            default: 10
          required: false
          description: 한 페이지에 포함될 항목 수. 기본값은 10입니다.
      responses:
        '200':
          description: 랭킹 순으로 정렬된 프로그램 목록 (페이지네이션 적용).
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProgramSummaryResponse'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /programs/{id}/bookmark:
    post:
      tags:
        - Programs
      summary: 프로그램 북마크 추가
      description: 현재 인증된 사용자의 특정 프로그램에 대한 북마크를 추가합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: 북마크할 프로그램의 ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: 북마크 추가 성공 (No Content)
        default:
          description: Unexpected server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /programs/{id}/unbookmark:
    post:
      tags:
        - Programs
      summary: 프로그램 북마크 제거
      description: 현재 인증된 사용자의 특정 프로그램에 대한 북마크를 제거합니다.
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: 북마크를 제거할 프로그램의 ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: 북마크 제거 성공 (No Content)
        default:
          description: Unexpected server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

components:
  schemas:
    AuthRequest:
      type: object
      properties:
        email:
          type: string
          example: john@email.com
        password:
          type: string
          example: this-is-password
      required:
        - email
        - password
    AuthResponse:
      type: object
      properties:
        accessToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
        refreshToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
        tokenType:
          type: string
          example: Bearer
        expiresIn:
          type: integer
          example: 3600
      required:
        - code
        - message

    User:
      type: object
      properties:
        id:
          type: string
          example: abcdef123456
        email:
          type: string
          example: john@email.com
        name:
          type: string
          example: John Doe
        birthDate:
          type: string
          format: LocalDate
          description: 사용자 생년월일(YYYY-MM-DD)
          example: 1988-01-01
        gender:
          type: string
          description: 성별 (남성/여성 중 하나, nullable)
          enum:
            - 남성
            - 여성
          example: 남성
        address:
          type: string
          description: 사용자의 주소지
          example: 서울특별시 강남구 테헤란로 123
        postcode:
          type: string
          description: 우편번호
          example: 06134
        maritalStatus:
          type: string
          description: 결혼 여부
          enum:
            - 미혼
            - 기혼
            - 이혼/사별
          example: 기혼
        educationLevel:
          type: string
          description: 최종 학력
          enum:
            - 초등학생
            - 중학생
            - 고등학생
            - 대학생
            - 초졸
            - 중졸
            - 고졸
            - 전문대졸
            - 대졸
          example: 대졸
        householdSize:
          type: integer
          description: 가구원 수
          minimum: 1
          example: 4
        householdIncome:
          type: integer
          description: 연간 가구원 소득(만원)
          example: 7500
        employmentStatus:
          type: string
          description: 고용 상태
          enum:
            - 재직자
            - 미취업자
            - 자영업자
          example: 재직자
    ProfileRequest:
      type: object
      properties:
        name:
          type: string
          example: John Doe
        birthDate:
          type: string
          format: LocalDate
          description: 사용자 생년월일(YYYY-MM-DD)
          example: 1988-01-01
        gender:
          type: string
          description: 성별 (MALE/FEMALE 중 하나, nullable)
          enum:
            - MALE
            - FEMALE
          example: FEMALE
        address:
          type: string
          description: 사용자의 주소지
          example: 서울특별시 강남구 테헤란로 123
        postcode:
          type: string
          description: 우편번호
          example: 06134
        maritalStatus:
          type: string
          description: 결혼 여부
          enum:
            - SINGLE
            - MARRIED
            - DIVORCED_OR_BEREAVED
          example: MARRIED
        educationLevel:
          type: string
          description: 최종 학력
          enum:
            - ELEMENTARY_SCHOOL_STUDENT
            - MIDDLE_SCHOOL_STUDENT
            - HIGH_SCHOOL_STUDENT
            - COLLEGE_STUDENT
            - ELEMENTARY_SCHOOL
            - MIDDLE_SCHOOL
            - HIGH_SCHOOL
            - ASSOCIATE
            - BACHELOR
          example: BACHELOR
        householdSize:
          type: integer
          description: 가구원 수
          minimum: 1
          example: 4
        householdIncome:
          type: integer
          description: 연간 가구원 소득(만원)
          example: 7500
        employmentStatus:
          type: string
          description: 고용 상태
          enum:
            - EMPLOYED
            - UNEMPLOYED
            - SELF_EMPLOYED
          example: EMPLOYED
    UserPreferenceUpdateRequest:
      type: object
      properties:
        satisfactionScores:
          type: array
          items:
            type: integer
            minimum: 1
            maximum: 5
          description: '프로그램 만족도 점수 리스트 (1~5 사이의 정수)'
          example: [3, 2, 1, 5, 4]
    ProgramResponse:
      type: object
      properties:
        id:
          type: integer
          description: '프로그램의 내부 식별자 (ID)'
          example: 1234
        uuid:
          type: string
          format: uuid
          description: '프로그램의 고유 식별자 (UUID)'
          example: abcdef123456
        category:
          type: string
          description: '프로그램 카테고리'
          enum:
            - 빈곤 완화
            - 보건, 의료
            - 돌봄, 요양
            - 치매 관련
            - 고용, 일자리
            - 사회, 여가문화 활동
            - 주거 지원
            - 기타
          example: 빈곤 완화
        title:
          type: string
          description: '프로그램 제목'
          example: "민생지원금 2차"
        details:
          type: string
          description: '프로그램 상세 내용'
          example: '코로나 19로 인한 경제적 피해를 극복하기 위한 지원금을 제공한다.'
        summary:
          type: string
          description: '프로그램 요약 내용'
          example: '코로나 19 경제적 피해 극복 지원금'
        preview:
          type: string
          description: '프로그램 미리보기 내용'
          example: '코로나 19로 인한 경제적 피해를 극복하기 위한 지원금'
        applicationMethod:
          type: string
          description: '신청 방법'
          example: '온라인 신청'
        applyUrl:
          type: string
          format: url
          description: '신청 URL'
          example: 'https://example.com/apply'
        eligibilityMinAge:
          type: integer
          description: '최소 연령'
          example: 19
        eligibilityMaxAge:
          type: integer
          description: '최대 연령'
          example: 65
        eligibilityMinHousehold:
          type: integer
          description: '최소 가구원 수'
          example: 1
        eligibilityMaxHousehold:
          type: integer
          description: '최대 가구원 수'
          example: 4
        eligibilityMinIncome:
          type: integer
          description: '최소 가구 소득 (만원)'
          example: 0
        eligibilityMaxIncome:
          type: integer
          description: '최대 가구 소득 (만원)'
          example: 7000
        eligibilityRegion:
          type: string
          description: '지원 대상 지역'
          example: '서울시'
        eligibilityGender:
          type: string
          description: '지원 대상 성별 (예: 남성, 여성)'
          enum:
            - 남성
            - 여성
          example: 여성
        eligibilityMaritalStatus:
          type: string
          description: '지원 대상 결혼 상태 (예: 미혼, 기혼, 무관)'
          enum:
            - 미혼
            - 기혼
            - 이혼/사별
          example: 기혼
        eligibilityEducation:
          type: string
          description: '지원 대상 학력 수준'
          enum:
            - 초등학생
            - 중학생
            - 고등학생
            - 대학생
            - 초졸
            - 중졸
            - 고졸
            - 전문대졸
            - 대졸
          example: 대졸
        eligibilityEmployment:
          type: string
          description: '지원 대상 고용 상태'
          enum:
            - 재직자
            - 미취업자
            - 자영업자
          example: 재직자
        applyStartAt:
          type: string
          format: OffsetDateTime
          description: '신청 시작 일시'
          example: '2024-01-01T09:00:00+09:00'
        applyEndAt:
          type: string
          format: OffsetDateTime
          description: '신청 종료 일시'
          example: '2024-03-31T18:00:00+09:00'
        createdAt:
          type: string
          format: OffsetDateTime
          description: '생성 일시'
          example: '2023-12-01T10:00:00+09:00'
        operatingEntity:
          type: string
          description: '운영 주체'
          example: '서울특별시'
    ProgramSummaryResponse:
      type: object
      properties:
        id:
          type: integer
          example: 1234
        title:
          type: string
          example: "민생지원금 2차"
        preview:
          type: string
          example: "코로나 19로 인한 경제적 피해를 극복하기 위한 지원금"
        operatingEntity:
          type: string
          example: "서울특별시"
          description: "운영 주체"
        category:
          type: string
          example: "cash"
          description: "프로그램 카테고리"
          enum:
            - cash
            - health
            - care
            - dementia
            - employment
            - leisure
            - housing
            - other
        categoryValue:
          type: string
          example: "빈곤 완화"
          description: "프로그램 카테고리 값"
          enum:
            - "빈곤 완화"
            - "보건, 의료"
            - "돌봄, 요양"
            - "치매 관련"
            - "고용, 일자리"
            - "사회, 여가문화 활동"
            - "주거 지원"
            - "기타"
    ProgramCategoryResponse:
      type: object
      properties:
        category:
          type: string
          description: "Program category identifier"
          example: cash
          enum:
            - cash
            - health
            - care
            - dementia
            - employment
            - leisure
            - housing
            - other
        value:
          type: string
          description: "Program category display name"
          example: "빈곤 완화"
          enum:
            - "빈곤 완화"
            - "보건, 의료"
            - "돌봄, 요양"
            - "치매 관련"
            - "고용, 일자리"
            - "사회, 여가문화 활동"
            - "주거 지원"
            - "기타"
    PreferenceUpdateRequest:
      type: object
      properties:
        id:
          type: number
        score:
          type: number
    BookmarkSortType:
      type: string
      description: 북마크 목록 정렬 기준
      enum:
        - LATEST
        - DEADLINE
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: 'JWT를 사용한 Bearer 인증'
